<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Image Generator Chatbot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://js.puter.com/v2/"></script>
    <style>
        :root {
            --primary-color: #4e6ef2;
            --secondary-color: #f0f2f5;
            --bot-msg-color: #ffffff;
            --user-msg-color: #e9f3ff;
            --text-color: #333333;
            --placeholder-color: #9ca3af;
            --border-radius: 18px;
            --transition-speed: 0.3s;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fb;
            color: var(--text-color);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .chat-container {
            width: 100%;
            max-width: 400px;
            height: 600px;
            background-color: #ffffff;
            border-radius: 24px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-header {
            padding: 20px;
            background-color: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .chat-header .avatar {
            width: 40px;
            height: 40px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .chat-header .avatar i {
            color: var(--primary-color);
            font-size: 20px;
        }

        .chat-header .info h2 {
            font-size: 18px;
            font-weight: 600;
        }

        .chat-header .info p {
            font-size: 14px;
            opacity: 0.8;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: var(--border-radius);
            animation: fadeIn 0.3s ease-in-out;
            position: relative;
            line-height: 1.5;
        }

        .message.bot {
            align-self: flex-start;
            background-color: var(--bot-msg-color);
            border-bottom-left-radius: 4px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
        }

        .message.user {
            align-self: flex-end;
            background-color: var(--user-msg-color);
            border-bottom-right-radius: 4px;
            color: #1a1a1a;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .message .timestamp {
            font-size: 11px;
            opacity: 0.6;
            margin-top: 5px;
            text-align: right;
        }

        .message img {
            max-width: 100%;
            border-radius: 8px;
            margin-top: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 12px 16px;
            background-color: var(--bot-msg-color);
            border-radius: var(--border-radius);
            border-bottom-left-radius: 4px;
            align-self: flex-start;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            border: 1px solid #e5e7eb;
            max-width: 80px;
            margin-bottom: 10px;
            display: none;
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            background-color: #b0b0b0;
            border-radius: 50%;
            display: inline-block;
            animation: bounce 1.5s infinite ease-in-out;
        }

        .typing-indicator span:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-indicator span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-indicator span:nth-child(3) {
            animation-delay: 0.4s;
        }

        .chat-input-container {
            padding: 16px;
            background-color: white;
            border-top: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #e5e7eb;
            border-radius: 24px;
            outline: none;
            font-size: 14px;
            transition: border-color var(--transition-speed);
            background-color: var(--secondary-color);
        }

        .chat-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(78, 110, 242, 0.1);
        }

        .chat-input::placeholder {
            color: var(--placeholder-color);
        }

        .send-button {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color var(--transition-speed);
        }

        .send-button:hover {
            background-color: #3a56d4;
        }

        .send-button:disabled {
            background-color: #b0b0b0;
            cursor: not-allowed;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounce {
            0%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-5px);
            }
        }

        /* Responsive adjustments */
        @media (max-width: 480px) {
            .chat-container {
                height: 100vh;
                max-width: 100%;
                border-radius: 0;
            }
            
            .message {
                max-width: 85%;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <div class="avatar">
                <i class="fas fa-robot"></i>
            </div>
            <div class="info">
                <h2>AI Image Generator</h2>
                <p>Powered by DALL-E 3</p>
            </div>
        </div>
        
        <div class="chat-messages" id="chat-messages">
            <div class="message bot">
                <div class="content">Hello! I can generate images using DALL-E 3. Try typing "generate: [your image description]" to create an image.</div>
                <div class="timestamp">12:00 PM</div>
            </div>
            
            <div class="typing-indicator" id="typing-indicator">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="chat-input-container">
            <input type="text" class="chat-input" id="chat-input" placeholder="Type 'generate: [description]' to create an image..." autocomplete="off">
            <button class="send-button" id="send-button">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const chatMessages = document.getElementById('chat-messages');
            const chatInput = document.getElementById('chat-input');
            const sendButton = document.getElementById('send-button');
            const typingIndicator = document.getElementById('typing-indicator');
            
            // Sample responses for the chatbot
            const botResponses = [
                "I'm here to help! What would you like to know?",
                "That's an interesting prompt. Let me generate that for you.",
                "I understand your request. Creating your image now...",
                "Thanks for the detailed description. Let me visualize that for you.",
                "I'm not sure I understand. Could you please try a different description?",
                "Creating your image. This might take a moment...",
                "Would you like to try another image prompt?",
                "DALL-E 3 is quite powerful at visualizing concepts!",
                "That's a creative idea! Let me generate that for you."
            ];
            
            // Function to get current time in HH:MM format
            function getCurrentTime() {
                const now = new Date();
                let hours = now.getHours();
                let minutes = now.getMinutes();
                const ampm = hours >= 12 ? 'PM' : 'AM';
                
                hours = hours % 12;
                hours = hours ? hours : 12; // the hour '0' should be '12'
                minutes = minutes < 10 ? '0' + minutes : minutes;
                
                return `${hours}:${minutes} ${ampm}`;
            }
            
            // Function to add a new message to the chat
            function addMessage(content, isUser = false, imageElement = null) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message');
                messageDiv.classList.add(isUser ? 'user' : 'bot');
                
                const contentDiv = document.createElement('div');
                contentDiv.classList.add('content');
                contentDiv.textContent = content;
                
                const timestampDiv = document.createElement('div');
                timestampDiv.classList.add('timestamp');
                timestampDiv.textContent = getCurrentTime();
                
                messageDiv.appendChild(contentDiv);
                
                // If there's an image element, append it
                if (imageElement) {
                    messageDiv.appendChild(imageElement);
                }
                
                messageDiv.appendChild(timestampDiv);
                
                chatMessages.appendChild(messageDiv);
                
                // Scroll to the bottom of the chat
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Function to generate an image using DALL-E 3
            function generateImage(prompt) {
                showTypingIndicator();
                
                // Add a message indicating image generation is in progress
                addMessage(`Generating image: "${prompt}"...`);
                
                // Use puter.ai to generate the image
                puter.ai.txt2img(prompt)
                    .then(imageElement => {
                        hideTypingIndicator();
                        
                        // Add the generated image to the chat
                        addMessage("Here's your generated image:", false, imageElement);
                    })
                    .catch(error => {
                        hideTypingIndicator();
                        addMessage(`Sorry, there was an error generating the image: ${error.message}`);
                    });
            }
            
            // Function to show typing indicator
            function showTypingIndicator() {
                typingIndicator.style.display = 'flex';
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Function to hide typing indicator
            function hideTypingIndicator() {
                typingIndicator.style.display = 'none';
            }
            
            // Function to handle sending a message
            function sendMessage() {
                const message = chatInput.value.trim();
                
                if (message) {
                    // Add user message
                    addMessage(message, true);
                    
                    // Clear input
                    chatInput.value = '';
                    
                    // Check if the message is an image generation request
                    if (message.toLowerCase().startsWith('generate:')) {
                        // Extract the prompt
                        const prompt = message.substring(9).trim();
                        
                        if (prompt) {
                            // Generate the image
                            generateImage(prompt);
                        } else {
                            // If no prompt was provided
                            addMessage("Please provide a description after 'generate:'");
                        }
                    } else {
                        // Show typing indicator
                        showTypingIndicator();
                        
                        // Simulate bot response after a delay
                        setTimeout(() => {
                            hideTypingIndicator();
                            
                            // Get random response
                            const randomResponse = botResponses[Math.floor(Math.random() * botResponses.length)];
                            addMessage(randomResponse);
                            
                            // Suggest using the generate command
                            if (!message.toLowerCase().includes('generate')) {
                                setTimeout(() => {
                                    addMessage("Remember, you can generate images by typing 'generate: [your description]'");
                                }, 1000);
                            }
                        }, 1500);
                    }
                }
            }
            
            // Event listeners
            sendButton.addEventListener('click', sendMessage);
            
            chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Enable/disable send button based on input
            chatInput.addEventListener('input', () => {
                sendButton.disabled = chatInput.value.trim() === '';
            });
            
            // Initialize
            sendButton.disabled = true;
        });
    </script>
</body>
</html>
